  <footer>
    <script src="https://immmmm.com/waterfall.min.js"></script>
    <script src="https://immmmm.com/imgStatus.min.js"></script>
    <script>
      // 立即执行的函数，避免污染全局作用域
      (function() {
          function parseMarkdownImages() {
              const datacontElements = document.querySelectorAll('.datacont');
              
              datacontElements.forEach(element => {
                  let content = element.innerHTML;
                  
                  // 将Markdown图片语法转换为HTML图片标签
                  content = content.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');
                  
                  element.innerHTML = content;
              });
              
              console.log('Markdown images parsed');  // 添加这行来确认脚本执行
          }
      
          // 当DOM加载完成时执行解析
          if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', parseMarkdownImages);
          } else {
              parseMarkdownImages();
          }
      })();
      </script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
      //外链 gallery 标签相册瀑布流
      var photosAll = document.getElementsByTagName('gallery') || '';
      if(photosAll){
        for(var i=0;i < photosAll.length;i++){
          photosAll[i].innerHTML = '<div class="gallery-photos">'+photosAll[i].innerHTML+'</div>'
          var photosIMG = photosAll[i].getElementsByTagName('img')
          for(var j=0;j < photosIMG.length;j++){
            wrap(photosIMG[j], document.createElement('div'));
          }
        }
      }
      function wrap(el, wrapper) {
        wrapper.className = "gallery-photo";
        el.parentNode.insertBefore(wrapper, el);
        wrapper.appendChild(el);
      }
      //相册瀑布流
      let galleryPhotos = document.querySelectorAll('.gallery-photos') || ''
      if(galleryPhotos){
        imgStatus.watch('.gallery-photo img', function(imgs) {
          if(imgs.isDone()){
            for(var i=0;i < galleryPhotos.length;i++){
              waterfall(galleryPhotos[i]);
              let pagePhoto = galleryPhotos[i].querySelectorAll('.gallery-photo');
              for(var j=0;j < pagePhoto.length;j++){pagePhoto[j].className += " visible"};
            }
          }
        });
        window.addEventListener('resize', function () {
          for(var i=0;i < galleryPhotos.length;i++){
            waterfall(galleryPhotos[i]);
          }
        });
      }
    });
    </script>
  {{ partial "foot_custom.html" . }}
  <hr>
  {{ partial "comments.html" . }}
  {{ partial "footer_highlightjs" . }}
  {{ with .Site.Params.footer }}
  <hr>
  <div class="copyright">{{ . | markdownify }}</div>
  {{ end }}
  </footer>
  </article>
  {{ template "_internal/google_analytics.html" . }}
  </body>
</html>
